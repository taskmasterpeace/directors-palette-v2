{
  "code_improvements": [
    {
      "id": "ci-001",
      "type": "code_improvements",
      "title": "Bulk Video Download as ZIP",
      "description": "Add ability to download multiple videos from the Shot Animator gallery as a single ZIP file with progress tracking, mirroring the existing bulk image download feature.",
      "rationale": "BulkDownloadService already exists for images in bulk-download.service.ts with progress callbacks, JSZip integration, and error handling per item. The same service architecture works for any URL-based content and can be extended to video files with minimal changes.",
      "builds_upon": ["BulkDownloadService for images", "JSZip integration", "Shot Animator video gallery"],
      "estimated_effort": "small",
      "affected_files": [
        "src/features/shot-creator/services/bulk-download.service.ts",
        "src/features/shot-animator/components/VideoGalleryGrid.tsx"
      ],
      "existing_patterns": [
        "BulkDownloadService.downloadAsZip() with progress callbacks",
        "DownloadProgress interface { current, total, status }",
        "getFilename() for URL-based filename extraction"
      ],
      "implementation_approach": "Extend BulkDownloadService.downloadAsZip() to handle video extensions (.mp4, .webm) in getFilename(). Add multi-select checkboxes to VideoGalleryGrid following the image gallery pattern. Create 'Download Selected' button that calls downloadAsZip with selected video URLs. Show progress modal during download using existing DownloadProgress interface.",
      "status": "draft",
      "created_at": "2025-12-25T17:55:00.000Z"
    },
    {
      "id": "ci-002",
      "type": "code_improvements",
      "title": "Wildcard Autocomplete in Prompt Input",
      "description": "Extend the existing @reference autocomplete to also support __wildcard__ syntax. When users type __ in the prompt input, show an autocomplete dropdown of available wildcards with descriptions and line counts for quick insertion.",
      "rationale": "The autocomplete infrastructure exists in usePromptAutocomplete.ts for @reference syntax with trigger detection, keyboard navigation, and item insertion. The wildcard service already provides getWildCards() with category filtering. Combining these enables seamless wildcard discovery.",
      "builds_upon": ["usePromptAutocomplete.ts @reference autocomplete", "wildcard.service.ts getWildCards()", "AutocompleteOption type system"],
      "estimated_effort": "medium",
      "affected_files": [
        "src/features/shot-creator/hooks/usePromptAutocomplete.ts",
        "src/features/shot-creator/types/autocomplete.types.ts",
        "src/features/shot-creator/components/creator-prompt-settings/PromptArea.tsx"
      ],
      "existing_patterns": [
        "detectTrigger() for @ symbol detection",
        "buildOptions() filtering and sorting",
        "insertItem() text replacement with cursor positioning",
        "Keyboard navigation (selectPrevious, selectNext)"
      ],
      "implementation_approach": "Add __ trigger detection in detectTrigger() alongside existing @ detection. Create WildcardAutocompleteItem type extending AutocompleteOption. Extend buildOptions() to fetch wildcards from service when __ triggered. Modify insertItem() to wrap selection in __name__ format. Show wildcard description and line count in dropdown items.",
      "status": "draft",
      "created_at": "2025-12-25T18:10:00.000Z"
    },
    {
      "id": "ci-003",
      "type": "code_improvements",
      "title": "Autosave for Layout Annotation Canvas",
      "description": "Implement autosave for the layout annotation canvas state to prevent work loss. Save canvas objects, positions, and settings to localStorage and offer recovery dialog on page reload.",
      "rationale": "The autosave pattern exists in useDraftAutosave.ts with 30-second interval saving, JSON snapshot comparison for change detection, and 24-hour expiration. The layout annotation has complex Fabric.js state that users can lose on accidental page close.",
      "builds_upon": ["useDraftAutosave.ts autosave pattern", "layout-annotation-store.ts canvas state", "RecoveryPrompt UI component"],
      "estimated_effort": "small",
      "affected_files": [
        "src/features/layout-annotation/hooks/useCanvasAutosave.ts",
        "src/features/layout-annotation/store/layout-annotation-store.ts",
        "src/features/layout-annotation/components/LayoutAnnotationCanvas.tsx"
      ],
      "existing_patterns": [
        "Interval-based autosave with timeoutRef",
        "JSON.stringify snapshot comparison",
        "loadDraft()/clearDraft()/hasDraft() utilities",
        "24-hour expiration check"
      ],
      "implementation_approach": "Create useCanvasAutosave hook following useDraftAutosave structure. Serialize canvas via Fabric.js toJSON(). Store with project ID and timestamp. Add recovery prompt on mount if draft exists. Implement loadCanvasDraft() to restore canvas.loadFromJSON(). Clear draft on explicit save or discard.",
      "status": "draft",
      "created_at": "2025-12-25T18:10:00.000Z"
    },
    {
      "id": "ci-004",
      "type": "code_improvements",
      "title": "Credit Transaction History Export",
      "description": "Allow users to export their credit transaction history to JSON or CSV format for record-keeping, accounting, and expense tracking purposes.",
      "rationale": "CreditsService.getTransactionHistory() already provides paginated transaction access. usePromptImportExport demonstrates the blob download pattern. Combining these enables transaction export without new backend work.",
      "builds_upon": ["CreditsService.getTransactionHistory()", "usePromptImportExport export pattern", "Transaction history UI"],
      "estimated_effort": "trivial",
      "affected_files": [
        "src/features/credits/hooks/useCreditExport.ts",
        "src/features/credits/components/CreditHistoryPanel.tsx"
      ],
      "existing_patterns": [
        "exportPrompts() blob download with URL.createObjectURL",
        "JSON.stringify with formatting and metadata",
        "Toast notifications for export success/failure"
      ],
      "implementation_approach": "Create useCreditExport hook with exportToJSON() and exportToCSV() functions. Fetch all transactions via getTransactionHistory with high limit. JSON export follows prompt pattern with version, exportDate, and transactions array. CSV export maps fields (date, type, amount, description, balance_after) to comma-separated rows. Add Export dropdown button to CreditHistoryPanel with JSON/CSV options.",
      "status": "draft",
      "created_at": "2025-12-25T17:55:00.000Z"
    },
    {
      "id": "ci-005",
      "type": "code_improvements",
      "title": "Multi-Select Gallery with Bulk Actions",
      "description": "Add multi-select mode to the unified image gallery with bulk actions toolbar (Download ZIP, Delete Selected, Move to Folder). Enable Shift+click for range selection and Ctrl+click for toggle selection.",
      "rationale": "The selection pattern exists in usePromptSelection.ts with Set-based tracking and selectAll/toggleSelect callbacks. BulkDownloadService handles ZIP creation. These can be combined with the existing gallery grid for powerful bulk operations.",
      "builds_upon": ["usePromptSelection.ts multi-select hook", "BulkDownloadService.downloadAsZip()", "UnifiedImageGallery component"],
      "estimated_effort": "medium",
      "affected_files": [
        "src/features/shot-creator/hooks/useGallerySelection.ts",
        "src/features/shot-creator/components/unified-gallery/UnifiedImageGallery.tsx",
        "src/features/shot-creator/components/unified-gallery/GalleryGrid.tsx",
        "src/features/shot-creator/components/unified-gallery/BulkActionsToolbar.tsx"
      ],
      "existing_patterns": [
        "Set-based selectedIds tracking",
        "selectAll/selectNone/toggleSelect/isSelected functions",
        "BulkDownloadService with progress callbacks",
        "Gallery image card hover states"
      ],
      "implementation_approach": "Create useGallerySelection hook based on usePromptSelection. Add selection mode toggle to gallery header. Show checkbox overlays on image cards when in selection mode. Create BulkActionsToolbar with Download/Delete/Move buttons. Implement range selection tracking for Shift+click. Connect actions to existing services (BulkDownloadService, gallery delete, folder move).",
      "status": "draft",
      "created_at": "2025-12-25T18:10:00.000Z"
    }
  ]
}
