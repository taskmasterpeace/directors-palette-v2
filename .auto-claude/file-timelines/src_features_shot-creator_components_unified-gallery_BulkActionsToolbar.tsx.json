{
  "file_path": "src/features/shot-creator/components/unified-gallery/BulkActionsToolbar.tsx",
  "main_branch_history": [],
  "task_views": {
    "013-multi-select-gallery-with-bulk-actions": {
      "task_id": "013-multi-select-gallery-with-bulk-actions",
      "branch_point": {
        "commit_hash": "8654231a22984c33942f63d8839bdca5b0d017c2",
        "content": "",
        "timestamp": "2025-12-25T18:57:10.314069"
      },
      "worktree_state": {
        "content": "'use client'\n\nimport { useState } from 'react'\nimport { motion, AnimatePresence } from 'framer-motion'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Download,\n  Trash2,\n  X,\n  FolderInput,\n  CheckSquare,\n} from 'lucide-react'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog'\nimport type { FolderWithCount } from '../../types/folder.types'\n\nexport interface BulkActionsToolbarProps {\n  /** Number of selected items */\n  selectedCount: number\n  /** List of available folders for move action */\n  folders?: FolderWithCount[]\n  /** Callback when clear selection is clicked */\n  onClearSelection: () => void\n  /** Callback when download ZIP is clicked */\n  onDownloadZip?: () => void\n  /** Callback when move to folder is selected */\n  onMoveToFolder?: (folderId: string | null) => void\n  /** Callback when create folder is clicked */\n  onCreateFolder?: () => void\n  /** Callback when delete is confirmed */\n  onDelete: () => void\n  /** Optional className for additional styling */\n  className?: string\n  /** External control for delete confirmation dialog (for keyboard shortcuts) */\n  deleteConfirmOpen?: boolean\n  /** Callback when delete confirmation dialog state changes */\n  onDeleteConfirmChange?: (open: boolean) => void\n}\n\n/**\n * Floating bulk actions toolbar that appears when items are selected.\n * Provides quick access to bulk operations: Download ZIP, Move to Folder, Delete.\n * Uses framer-motion for smooth enter/exit animations.\n * Mobile-responsive with condensed layout on smaller screens.\n */\nexport function BulkActionsToolbar({\n  selectedCount,\n  folders = [],\n  onClearSelection,\n  onDownloadZip,\n  onMoveToFolder,\n  onCreateFolder,\n  onDelete,\n  className = '',\n  deleteConfirmOpen,\n  onDeleteConfirmChange,\n}: BulkActionsToolbarProps) {\n  const [internalShowDeleteConfirm, setInternalShowDeleteConfirm] = useState(false)\n\n  // Use external control if provided, otherwise use internal state\n  const showDeleteConfirm = deleteConfirmOpen ?? internalShowDeleteConfirm\n  const setShowDeleteConfirm = onDeleteConfirmChange ?? setInternalShowDeleteConfirm\n\n  // Don't render if nothing is selected\n  if (selectedCount === 0) {\n    return null\n  }\n\n  return (\n    <>\n      <AnimatePresence>\n        {selectedCount > 0 && (\n          <motion.div\n            initial={{ opacity: 0, y: 20, scale: 0.95 }}\n            animate={{ opacity: 1, y: 0, scale: 1 }}\n            exit={{ opacity: 0, y: 20, scale: 0.95 }}\n            transition={{\n              duration: 0.2,\n              ease: [0.4, 0, 0.2, 1]\n            }}\n            className={`fixed bottom-4 left-1/2 -translate-x-1/2 z-50 ${className}`}\n          >\n            <div className=\"flex items-center gap-2 px-4 py-2.5 rounded-full bg-card/95 backdrop-blur-md border border-border shadow-lg shadow-black/20\">\n              {/* Selection indicator */}\n              <div className=\"flex items-center gap-2\">\n                <CheckSquare className=\"w-4 h-4 text-primary\" />\n                <Badge\n                  variant=\"default\"\n                  className=\"bg-primary text-primary-foreground px-2.5 py-0.5 text-sm font-medium\"\n                >\n                  {selectedCount} selected\n                </Badge>\n              </div>\n\n              {/* Divider */}\n              <div className=\"h-6 w-px bg-border mx-1\" />\n\n              {/* Action buttons */}\n              <div className=\"flex items-center gap-1.5\">\n                {/* Download ZIP Button */}\n                {onDownloadZip && (\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={onDownloadZip}\n                    className=\"h-8 px-3 rounded-full hover:bg-accent/50\"\n                  >\n                    <Download className=\"w-4 h-4 mr-1.5\" />\n                    <span className=\"hidden sm:inline\">Download</span>\n                  </Button>\n                )}\n\n                {/* Move to Folder Dropdown */}\n                {onMoveToFolder && (\n                  <DropdownMenu>\n                    <DropdownMenuTrigger asChild>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"h-8 px-3 rounded-full hover:bg-accent/50\"\n                      >\n                        <FolderInput className=\"w-4 h-4 mr-1.5\" />\n                        <span className=\"hidden sm:inline\">Move</span>\n                      </Button>\n                    </DropdownMenuTrigger>\n                    <DropdownMenuContent\n                      align=\"center\"\n                      side=\"top\"\n                      sideOffset={8}\n                      className=\"bg-card border-border max-h-64 overflow-y-auto\"\n                    >\n                      <DropdownMenuItem\n                        onClick={() => onMoveToFolder(null)}\n                        className=\"cursor-pointer\"\n                      >\n                        <span>Uncategorized</span>\n                      </DropdownMenuItem>\n\n                      {onCreateFolder && (\n                        <DropdownMenuItem\n                          onClick={onCreateFolder}\n                          className=\"cursor-pointer text-primary\"\n                        >\n                          <FolderInput className=\"w-4 h-4 mr-2\" />\n                          <span>Create new folder...</span>\n                        </DropdownMenuItem>\n                      )}\n\n                      {(folders.length > 0 || onCreateFolder) && (\n                        <DropdownMenuSeparator />\n                      )}\n\n                      {folders.map(folder => (\n                        <DropdownMenuItem\n                          key={folder.id}\n                          onClick={() => onMoveToFolder(folder.id)}\n                          className=\"cursor-pointer\"\n                        >\n                          <div className=\"flex items-center gap-2 w-full\">\n                            {folder.color && (\n                              <div\n                                className=\"h-3 w-3 rounded-full border border-border flex-shrink-0\"\n                                style={{ backgroundColor: folder.color }}\n                              />\n                            )}\n                            <span className=\"flex-1\">{folder.name}</span>\n                            <span className=\"text-muted-foreground text-xs\">\n                              ({folder.imageCount})\n                            </span>\n                          </div>\n                        </DropdownMenuItem>\n                      ))}\n\n                      {folders.length === 0 && !onCreateFolder && (\n                        <div className=\"px-2 py-1.5 text-sm text-muted-foreground\">\n                          No folders created yet\n                        </div>\n                      )}\n                    </DropdownMenuContent>\n                  </DropdownMenu>\n                )}\n\n                {/* Delete Button */}\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => setShowDeleteConfirm(true)}\n                  className=\"h-8 px-3 rounded-full text-destructive hover:text-destructive hover:bg-destructive/10\"\n                >\n                  <Trash2 className=\"w-4 h-4 mr-1.5\" />\n                  <span className=\"hidden sm:inline\">Delete</span>\n                </Button>\n\n                {/* Divider */}\n                <div className=\"h-6 w-px bg-border mx-1\" />\n\n                {/* Clear Selection Button */}\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={onClearSelection}\n                  className=\"h-8 w-8 rounded-full hover:bg-accent/50\"\n                  aria-label=\"Clear selection\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={showDeleteConfirm} onOpenChange={setShowDeleteConfirm}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete {selectedCount} images?</AlertDialogTitle>\n            <AlertDialogDescription>\n              This action cannot be undone. These images will be permanently deleted\n              from your gallery and storage.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => {\n                onDelete()\n                setShowDeleteConfirm(false)\n              }}\n              className=\"bg-destructive hover:bg-destructive/90\"\n            >\n              Delete {selectedCount} Images\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  )\n}\n",
        "last_modified": "2025-12-25T19:32:48.521888"
      },
      "task_intent": {
        "title": "013-multi-select-gallery-with-bulk-actions",
        "description": "Add multi-select mode to the unified image gallery with bulk actions toolbar (Download ZIP, Delete Selected, Move to Folder). Enable Shift+click for range selection and Ctrl+click for toggle selection.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2025-12-25T18:55:48.889229",
  "last_updated": "2025-12-25T18:57:10.767327"
}